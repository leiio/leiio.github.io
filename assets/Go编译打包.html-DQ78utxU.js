import{_ as c}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as l,o as i,c as u,b as n,a,w as p,d as s,f as e}from"./app-BGG14fOW.js";const r={},k=n("h1",{id:"go编译打包",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#go编译打包","aria-hidden":"true"},"#"),s(" Go编译打包")],-1),d={class:"table-of-contents"},b=n("h2",{id:"flag",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#flag","aria-hidden":"true"},"#"),s(" Flag")],-1),m={href:"https://c.isme.pub/2019/01/10/go-static",target:"_blank",rel:"noopener noreferrer"},g=e('<blockquote><p>下载打包脚本<a href="/files/go_7z_pack.bat">go_7z_pack.bat</a>或<a href="/files/go_pack.sh">go_pack.sh</a>文件并保存到项目根目录中， 且修改脚本中的<code>files</code>变量保存执行脚本即可</p></blockquote><p><strong>cross compile</strong></p><blockquote><p>交叉编译器（英语：Cross compiler）是指一个在某个系统平台下可以产生另一个系统平台的可执行文件的编译器。 交叉编译器在目标系统平台（开发出来的应用程序序所运行的平台）难以或不容易编译时非常有用。</p></blockquote><blockquote><p>交叉编译是在一个平台上生成另一个平台上的可执行代码。同一个体系结构可以运行不同的操作系统； 同样，同一个操作系统也可以在不同的体系结构上运行。</p></blockquote><h2 id="第三方库" tabindex="-1"><a class="header-anchor" href="#第三方库" aria-hidden="true">#</a> 第三方库</h2>',5),h={href:"https://github.com/mitchellh/gox",target:"_blank",rel:"noopener noreferrer"},v={href:"https://github.com/wheelcomplex/goxx",target:"_blank",rel:"noopener noreferrer"},q={href:"https://github.com/goreleaser/goreleaser",target:"_blank",rel:"noopener noreferrer"},f={href:"https://github.com/laher/goxc",target:"_blank",rel:"noopener noreferrer"},_={href:"https://github.com/karalabe/xgo",target:"_blank",rel:"noopener noreferrer"},O={href:"https://github.com/techknowlogick/xgo",target:"_blank",rel:"noopener noreferrer"},y={href:"https://github.com/storyicon/gos",target:"_blank",rel:"noopener noreferrer"},G={href:"https://github.com/docker/golang-cross",target:"_blank",rel:"noopener noreferrer"},x={href:"https://github.com/im4x5yn74x/dropper2",target:"_blank",rel:"noopener noreferrer"},w={href:"https://github.com/tinygo-org/tinygo",target:"_blank",rel:"noopener noreferrer"},S=n("p",null,[n("strong",null,"嵌入静态资源")],-1),C={href:"https://github.com/go-bindata/go-bindata",target:"_blank",rel:"noopener noreferrer"},A={href:"https://github.com/caixw/gobuild",target:"_blank",rel:"noopener noreferrer"},R={href:"https://github.com/shuLhan/go-bindata",target:"_blank",rel:"noopener noreferrer"},H={href:"https://github.com/elazarl/go-bindata-assetfs",target:"_blank",rel:"noopener noreferrer"},E={href:"https://github.com/rakyll/statik",target:"_blank",rel:"noopener noreferrer"},L={href:"https://github.com/GeertJohan/go.rice",target:"_blank",rel:"noopener noreferrer"},P={href:"https://github.com/mjibson/esc",target:"_blank",rel:"noopener noreferrer"},V={href:"https://github.com/UnnoTed/fileb0x",target:"_blank",rel:"noopener noreferrer"},N={href:"https://github.com/gobuffalo/packr",target:"_blank",rel:"noopener noreferrer"},F={href:"https://github.com/alecthomas/gobundle",target:"_blank",rel:"noopener noreferrer"},I={href:"https://github.com/go-playground/statics",target:"_blank",rel:"noopener noreferrer"},T={href:"https://github.com/knadh/stuffbin",target:"_blank",rel:"noopener noreferrer"},B={href:"https://github.com/omeid/go-resources",target:"_blank",rel:"noopener noreferrer"},D={href:"https://github.com/phogolabs/parcello",target:"_blank",rel:"noopener noreferrer"},j={href:"https://github.com/pyros2097/go-embed",target:"_blank",rel:"noopener noreferrer"},z={href:"https://github.com/shurcooL/vfsgen",target:"_blank",rel:"noopener noreferrer"},U={href:"https://github.com/wlbr/templify",target:"_blank",rel:"noopener noreferrer"},X={href:"https://perkeep.org/pkg/fileembed",target:"_blank",rel:"noopener noreferrer"},J={href:"https://github.com/kevinburke/go-bindata",target:"_blank",rel:"noopener noreferrer"},M={href:"https://github.com/markbates/pkger",target:"_blank",rel:"noopener noreferrer"},Q=n("h2",{id:"embed内嵌文件",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#embed内嵌文件","aria-hidden":"true"},"#"),s(" embed内嵌文件")],-1),K={href:"https://github.com/golang/proposal/blob/master/design/draft-embed.md",target:"_blank",rel:"noopener noreferrer"},W={href:"https://github.com/alimy/embedx",target:"_blank",rel:"noopener noreferrer"},Y=e("<blockquote><p>在go1.6版本之前要想把资源文件嵌入到编译的二进制包中必须用第三方包（除非你自己有实现），要么把所有文件压缩在一起</p></blockquote><ul><li>embed一共有三种数据格式</li></ul><table><thead><tr><th>数据类型</th><th>说明</th></tr></thead><tbody><tr><td>[]byte</td><td>表示数据存储为二进制格式，如果只使用[]byte和string需要以import (_ &quot;embed&quot;)的形式引入embed标准库</td></tr><tr><td>string</td><td>表示数据被编码成utf8编码的字符串，因此不要用这个格式嵌入二进制文件比如图片，引入embed的规则同[]byte</td></tr><tr><td>embed.FS</td><td>表示存储多个文件和目录的结构，[]byte和string只能存储单个文件</td></tr></tbody></table>",3),Z={href:"https://mp.weixin.qq.com/s/SiCTV7R2wA_I2nCQkC3GGQ",target:"_blank",rel:"noopener noreferrer"},$={href:"https://www.cnblogs.com/apocelipes/p/13907858.html",target:"_blank",rel:"noopener noreferrer"},nn=n("h2",{id:"打包命令",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#打包命令","aria-hidden":"true"},"#"),s(" 打包命令")],-1),sn={href:"https://golang.google.cn/doc/install/source#environment",target:"_blank",rel:"noopener noreferrer"},an={href:"https://gist.github.com/asukakenji/f15ba7e588ac42795f421b48b8aede63",target:"_blank",rel:"noopener noreferrer"},tn=n("h3",{id:"设置编译环境",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#设置编译环境","aria-hidden":"true"},"#"),s(" 设置编译环境")],-1),on={href:"https://github.com/golang/go/blob/master/src/cmd/dist/build.go#L1513",target:"_blank",rel:"noopener noreferrer"},pn=e("<ul><li><code>go tool dist list</code> 获得所有受支持平台的列表</li><li><code>GOOS</code> 目标可执行程序运行操作系统，支持<code>darwin</code>、<code>freebsd</code>、<code>linux</code>、<code>windows</code></li><li><code>GOARCH</code> 目标平台的体系架构，包括<code>386</code>、<code>amd64</code>、<code>arm</code></li><li><code>CGO_ENABLED</code> CGO开关</li><li><code>-o</code> 参数为指定输出程序文件名</li><li><code>go clean -cache</code> 编译完成清理缓存</li></ul><p><strong><code>-ldflags</code>选项</strong></p>",2),en=n("code",null,"ldflags",-1),ln=n("code",null,"go tool link",-1),cn={href:"https://www.godoc.org/cmd/link",target:"_blank",rel:"noopener noreferrer"},un=e(`<blockquote><p><code>-ldflags=&quot;-w -s&quot;</code> 选项可以减小编译后的程序体积</p></blockquote><blockquote><p>注意因为<code>date</code>和<code>go version</code>的输出有空格，所以<code>main.BUILD_TIME</code>和<code>main.GO_VERSION</code>必须使用引号括起来</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>go build <span class="token parameter variable">-ldflags</span> <span class="token string">&quot;-X main.VERSION=1.0.0 -X &#39;main.BUILD_TIME=<span class="token variable"><span class="token variable">\`</span><span class="token function">date</span><span class="token variable">\`</span></span>&#39; \\
-X &#39;main.GO_VERSION=<span class="token variable"><span class="token variable">\`</span>go version<span class="token variable">\`</span></span>&#39; -X &#39;main.commitHash=<span class="token variable"><span class="token variable">\`</span><span class="token function">git</span> rev-parse HEAD<span class="token variable">\`</span></span>&#39;&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="windows" tabindex="-1"><a class="header-anchor" href="#windows" aria-hidden="true">#</a> windows</h3><blockquote><p><code>-ldflags=&quot;-H windowsgui&quot;</code> 能隐藏黑窗口</p></blockquote><div class="language-batch line-numbers-mode" data-ext="batch"><pre class="language-batch"><code># 交叉编译不支持 CGO 所以要禁用它
<span class="token command"><span class="token keyword">SET</span> <span class="token variable">CGO_ENABLED</span><span class="token operator">=</span><span class="token number">0</span></span>
# 打包Linux 执行文件
<span class="token command"><span class="token keyword">SET</span> <span class="token variable">GOOS</span><span class="token operator">=</span>linux</span>
# 打包386执行文件
<span class="token command"><span class="token keyword">SET</span> <span class="token variable">GOARCH</span><span class="token operator">=</span>amd64</span>

<span class="token command"><span class="token keyword">go</span> build main.go</span>
# 打包文件成其他名字
<span class="token command"><span class="token keyword">go</span> build <span class="token parameter attr-name">-o</span> test.exe main.go</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="linux" tabindex="-1"><a class="header-anchor" href="#linux" aria-hidden="true">#</a> linux</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token assign-left variable">CGO_ENABLED</span><span class="token operator">=</span><span class="token number">0</span> <span class="token assign-left variable">GOOS</span><span class="token operator">=</span>windows <span class="token assign-left variable">GOARCH</span><span class="token operator">=</span>amd64 go build main.go
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="交叉编译代码" tabindex="-1"><a class="header-anchor" href="#交叉编译代码" aria-hidden="true">#</a> 交叉编译代码</h3><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;flag&quot;</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;os&quot;</span>
	<span class="token string">&quot;os/exec&quot;</span>
	<span class="token string">&quot;path&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> syslist <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	GOOS   <span class="token builtin">string</span>
	GOARCH <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> syslists <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span>syslist

<span class="token keyword">func</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	syslists<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> syslist<span class="token punctuation">{</span>GOOS<span class="token punctuation">:</span> <span class="token string">&quot;darwin&quot;</span><span class="token punctuation">,</span> GOARCH<span class="token punctuation">:</span> <span class="token string">&quot;386&quot;</span><span class="token punctuation">}</span>
	syslists<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> syslist<span class="token punctuation">{</span>GOOS<span class="token punctuation">:</span> <span class="token string">&quot;darwin&quot;</span><span class="token punctuation">,</span> GOARCH<span class="token punctuation">:</span> <span class="token string">&quot;amd64&quot;</span><span class="token punctuation">}</span>
	syslists<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> syslist<span class="token punctuation">{</span>GOOS<span class="token punctuation">:</span> <span class="token string">&quot;dragonfly&quot;</span><span class="token punctuation">,</span> GOARCH<span class="token punctuation">:</span> <span class="token string">&quot;amd64&quot;</span><span class="token punctuation">}</span>
	syslists<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> syslist<span class="token punctuation">{</span>GOOS<span class="token punctuation">:</span> <span class="token string">&quot;freebsd&quot;</span><span class="token punctuation">,</span> GOARCH<span class="token punctuation">:</span> <span class="token string">&quot;386&quot;</span><span class="token punctuation">}</span>
	syslists<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> syslist<span class="token punctuation">{</span>GOOS<span class="token punctuation">:</span> <span class="token string">&quot;freebsd&quot;</span><span class="token punctuation">,</span> GOARCH<span class="token punctuation">:</span> <span class="token string">&quot;amd64&quot;</span><span class="token punctuation">}</span>
	syslists<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> syslist<span class="token punctuation">{</span>GOOS<span class="token punctuation">:</span> <span class="token string">&quot;freebsd&quot;</span><span class="token punctuation">,</span> GOARCH<span class="token punctuation">:</span> <span class="token string">&quot;arm&quot;</span><span class="token punctuation">}</span>
	syslists<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> syslist<span class="token punctuation">{</span>GOOS<span class="token punctuation">:</span> <span class="token string">&quot;linux&quot;</span><span class="token punctuation">,</span> GOARCH<span class="token punctuation">:</span> <span class="token string">&quot;386&quot;</span><span class="token punctuation">}</span>
	syslists<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">=</span> syslist<span class="token punctuation">{</span>GOOS<span class="token punctuation">:</span> <span class="token string">&quot;linux&quot;</span><span class="token punctuation">,</span> GOARCH<span class="token punctuation">:</span> <span class="token string">&quot;amd64&quot;</span><span class="token punctuation">}</span>
	syslists<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">=</span> syslist<span class="token punctuation">{</span>GOOS<span class="token punctuation">:</span> <span class="token string">&quot;linux&quot;</span><span class="token punctuation">,</span> GOARCH<span class="token punctuation">:</span> <span class="token string">&quot;arm&quot;</span><span class="token punctuation">}</span>
	syslists<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">=</span> syslist<span class="token punctuation">{</span>GOOS<span class="token punctuation">:</span> <span class="token string">&quot;linux&quot;</span><span class="token punctuation">,</span> GOARCH<span class="token punctuation">:</span> <span class="token string">&quot;arm64&quot;</span><span class="token punctuation">}</span>
	syslists<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> syslist<span class="token punctuation">{</span>GOOS<span class="token punctuation">:</span> <span class="token string">&quot;linux&quot;</span><span class="token punctuation">,</span> GOARCH<span class="token punctuation">:</span> <span class="token string">&quot;ppc64&quot;</span><span class="token punctuation">}</span>
	syslists<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">=</span> syslist<span class="token punctuation">{</span>GOOS<span class="token punctuation">:</span> <span class="token string">&quot;linux&quot;</span><span class="token punctuation">,</span> GOARCH<span class="token punctuation">:</span> <span class="token string">&quot;ppc64le&quot;</span><span class="token punctuation">}</span>
	syslists<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">=</span> syslist<span class="token punctuation">{</span>GOOS<span class="token punctuation">:</span> <span class="token string">&quot;linux&quot;</span><span class="token punctuation">,</span> GOARCH<span class="token punctuation">:</span> <span class="token string">&quot;mips&quot;</span><span class="token punctuation">}</span>
	syslists<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">=</span> syslist<span class="token punctuation">{</span>GOOS<span class="token punctuation">:</span> <span class="token string">&quot;linux&quot;</span><span class="token punctuation">,</span> GOARCH<span class="token punctuation">:</span> <span class="token string">&quot;mipsle&quot;</span><span class="token punctuation">}</span>
	syslists<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">=</span> syslist<span class="token punctuation">{</span>GOOS<span class="token punctuation">:</span> <span class="token string">&quot;linux&quot;</span><span class="token punctuation">,</span> GOARCH<span class="token punctuation">:</span> <span class="token string">&quot;mips64&quot;</span><span class="token punctuation">}</span>
	syslists<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">=</span> syslist<span class="token punctuation">{</span>GOOS<span class="token punctuation">:</span> <span class="token string">&quot;linux&quot;</span><span class="token punctuation">,</span> GOARCH<span class="token punctuation">:</span> <span class="token string">&quot;mips64le&quot;</span><span class="token punctuation">}</span>
	syslists<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">=</span> syslist<span class="token punctuation">{</span>GOOS<span class="token punctuation">:</span> <span class="token string">&quot;linux&quot;</span><span class="token punctuation">,</span> GOARCH<span class="token punctuation">:</span> <span class="token string">&quot;s390x&quot;</span><span class="token punctuation">}</span>
	syslists<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">=</span> syslist<span class="token punctuation">{</span>GOOS<span class="token punctuation">:</span> <span class="token string">&quot;nacl&quot;</span><span class="token punctuation">,</span> GOARCH<span class="token punctuation">:</span> <span class="token string">&quot;386&quot;</span><span class="token punctuation">}</span>
	syslists<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">=</span> syslist<span class="token punctuation">{</span>GOOS<span class="token punctuation">:</span> <span class="token string">&quot;nacl&quot;</span><span class="token punctuation">,</span> GOARCH<span class="token punctuation">:</span> <span class="token string">&quot;amd64p32&quot;</span><span class="token punctuation">}</span>
	syslists<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">=</span> syslist<span class="token punctuation">{</span>GOOS<span class="token punctuation">:</span> <span class="token string">&quot;nacl&quot;</span><span class="token punctuation">,</span> GOARCH<span class="token punctuation">:</span> <span class="token string">&quot;arm&quot;</span><span class="token punctuation">}</span>
	syslists<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">=</span> syslist<span class="token punctuation">{</span>GOOS<span class="token punctuation">:</span> <span class="token string">&quot;netbsd&quot;</span><span class="token punctuation">,</span> GOARCH<span class="token punctuation">:</span> <span class="token string">&quot;386&quot;</span><span class="token punctuation">}</span>
	syslists<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">=</span> syslist<span class="token punctuation">{</span>GOOS<span class="token punctuation">:</span> <span class="token string">&quot;netbsd&quot;</span><span class="token punctuation">,</span> GOARCH<span class="token punctuation">:</span> <span class="token string">&quot;amd64&quot;</span><span class="token punctuation">}</span>
	syslists<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">=</span> syslist<span class="token punctuation">{</span>GOOS<span class="token punctuation">:</span> <span class="token string">&quot;netbsd&quot;</span><span class="token punctuation">,</span> GOARCH<span class="token punctuation">:</span> <span class="token string">&quot;arm&quot;</span><span class="token punctuation">}</span>
	syslists<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">=</span> syslist<span class="token punctuation">{</span>GOOS<span class="token punctuation">:</span> <span class="token string">&quot;openbsd&quot;</span><span class="token punctuation">,</span> GOARCH<span class="token punctuation">:</span> <span class="token string">&quot;386&quot;</span><span class="token punctuation">}</span>
	syslists<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">=</span> syslist<span class="token punctuation">{</span>GOOS<span class="token punctuation">:</span> <span class="token string">&quot;openbsd&quot;</span><span class="token punctuation">,</span> GOARCH<span class="token punctuation">:</span> <span class="token string">&quot;amd64&quot;</span><span class="token punctuation">}</span>
	syslists<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">=</span> syslist<span class="token punctuation">{</span>GOOS<span class="token punctuation">:</span> <span class="token string">&quot;openbsd&quot;</span><span class="token punctuation">,</span> GOARCH<span class="token punctuation">:</span> <span class="token string">&quot;arm&quot;</span><span class="token punctuation">}</span>
	syslists<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token operator">=</span> syslist<span class="token punctuation">{</span>GOOS<span class="token punctuation">:</span> <span class="token string">&quot;plan9&quot;</span><span class="token punctuation">,</span> GOARCH<span class="token punctuation">:</span> <span class="token string">&quot;386&quot;</span><span class="token punctuation">}</span>
	syslists<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span> <span class="token operator">=</span> syslist<span class="token punctuation">{</span>GOOS<span class="token punctuation">:</span> <span class="token string">&quot;plan9&quot;</span><span class="token punctuation">,</span> GOARCH<span class="token punctuation">:</span> <span class="token string">&quot;amd64&quot;</span><span class="token punctuation">}</span>
	syslists<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span> <span class="token operator">=</span> syslist<span class="token punctuation">{</span>GOOS<span class="token punctuation">:</span> <span class="token string">&quot;plan9&quot;</span><span class="token punctuation">,</span> GOARCH<span class="token punctuation">:</span> <span class="token string">&quot;arm&quot;</span><span class="token punctuation">}</span>
	syslists<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span> <span class="token operator">=</span> syslist<span class="token punctuation">{</span>GOOS<span class="token punctuation">:</span> <span class="token string">&quot;solaris&quot;</span><span class="token punctuation">,</span> GOARCH<span class="token punctuation">:</span> <span class="token string">&quot;amd64&quot;</span><span class="token punctuation">}</span>
	syslists<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">=</span> syslist<span class="token punctuation">{</span>GOOS<span class="token punctuation">:</span> <span class="token string">&quot;windows&quot;</span><span class="token punctuation">,</span> GOARCH<span class="token punctuation">:</span> <span class="token string">&quot;386&quot;</span><span class="token punctuation">}</span>
	syslists<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span> <span class="token operator">=</span> syslist<span class="token punctuation">{</span>GOOS<span class="token punctuation">:</span> <span class="token string">&quot;windows&quot;</span><span class="token punctuation">,</span> GOARCH<span class="token punctuation">:</span> <span class="token string">&quot;amd64&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 编译</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 文件存放目录</span>
	<span class="token keyword">var</span> parentFolder <span class="token builtin">string</span>
	<span class="token comment">// 编译输出存放的子目录</span>
	<span class="token keyword">var</span> subFolder <span class="token builtin">string</span>
	<span class="token comment">// 文件名前缀</span>
	<span class="token keyword">var</span> filePrefix <span class="token builtin">string</span>
	<span class="token comment">// 要编译的源文件列表</span>
	<span class="token keyword">var</span> files <span class="token builtin">string</span>
	<span class="token comment">// scanner := bufio.NewScanner(os.Stdin)</span>
	<span class="token comment">// scanner.Scan()</span>
	<span class="token comment">// fmt.Println(scanner.Text())</span>
	<span class="token comment">//fmt.Println(&quot;请输文件存放目录：&quot;)</span>
	<span class="token comment">// 当程序到此，会停止执行等待用户输入</span>
	<span class="token comment">//fmt.Scanln(&amp;parentFolder)</span>

	flag<span class="token punctuation">.</span><span class="token function">StringVar</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>parentFolder<span class="token punctuation">,</span> <span class="token string">&quot;p&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;文件存放目录，默认：当前目录&quot;</span><span class="token punctuation">)</span>
	flag<span class="token punctuation">.</span><span class="token function">StringVar</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>subFolder<span class="token punctuation">,</span> <span class="token string">&quot;s&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;编译输出存放子目录，默认：空&quot;</span><span class="token punctuation">)</span>
	flag<span class="token punctuation">.</span><span class="token function">StringVar</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>filePrefix<span class="token punctuation">,</span> <span class="token string">&quot;fp&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;创建文件名前缀，默认：空&quot;</span><span class="token punctuation">)</span>
	flag<span class="token punctuation">.</span><span class="token function">StringVar</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>files<span class="token punctuation">,</span> <span class="token string">&quot;fs&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;源文件列表，默认：空&quot;</span><span class="token punctuation">)</span>
	flag<span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	cmde <span class="token operator">:=</span> path<span class="token punctuation">.</span><span class="token function">Join</span><span class="token punctuation">(</span>parentFolder<span class="token punctuation">,</span> subFolder<span class="token punctuation">,</span> filePrefix<span class="token punctuation">)</span>
	<span class="token keyword">if</span> filePrefix <span class="token operator">!=</span> <span class="token string">&quot;&quot;</span> <span class="token operator">&amp;&amp;</span> <span class="token function">len</span><span class="token punctuation">(</span>filePrefix<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
		cmde <span class="token operator">=</span> cmde <span class="token operator">+</span> <span class="token string">&quot;-&quot;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> v <span class="token operator">:=</span> <span class="token keyword">range</span> syslists <span class="token punctuation">{</span>
		ext <span class="token operator">:=</span> <span class="token string">&quot;&quot;</span>
		<span class="token keyword">if</span> v<span class="token punctuation">.</span>GOOS <span class="token operator">==</span> <span class="token string">&quot;windows&quot;</span> <span class="token punctuation">{</span>
			ext <span class="token operator">=</span> <span class="token string">&quot;.exe&quot;</span>
		<span class="token punctuation">}</span>
		thisCmde <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;%v%v-%v%v&quot;</span><span class="token punctuation">,</span> cmde<span class="token punctuation">,</span> v<span class="token punctuation">.</span>GOOS<span class="token punctuation">,</span> v<span class="token punctuation">.</span>GOARCH<span class="token punctuation">,</span> ext<span class="token punctuation">)</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>thisCmde<span class="token punctuation">)</span>
		cmd <span class="token operator">:=</span> exec<span class="token punctuation">.</span><span class="token function">Command</span><span class="token punctuation">(</span><span class="token string">&quot;go&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;build&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-ldflags=-w&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-i&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-o&quot;</span><span class="token punctuation">,</span> thisCmde<span class="token punctuation">,</span> files<span class="token punctuation">)</span>
		cmd<span class="token punctuation">.</span>Env <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span><span class="token function">Environ</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;GOARCH=&quot;</span><span class="token operator">+</span>v<span class="token punctuation">.</span>GOARCH<span class="token punctuation">,</span> <span class="token string">&quot;GOOS=&quot;</span><span class="token operator">+</span>v<span class="token punctuation">.</span>GOOS<span class="token punctuation">)</span>
		output<span class="token punctuation">,</span> err <span class="token operator">:=</span> cmd<span class="token punctuation">.</span><span class="token function">CombinedOutput</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token function">Sprint</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;: &quot;</span> <span class="token operator">+</span> <span class="token function">string</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token keyword">return</span>
		<span class="token punctuation">}</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">string</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;编译完成&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,10);function rn(kn,dn){const o=l("router-link"),t=l("ExternalLinkIcon");return i(),u("div",null,[k,n("nav",d,[n("ul",null,[n("li",null,[a(o,{to:"#flag"},{default:p(()=>[s("Flag")]),_:1})]),n("li",null,[a(o,{to:"#第三方库"},{default:p(()=>[s("第三方库")]),_:1})]),n("li",null,[a(o,{to:"#embed内嵌文件"},{default:p(()=>[s("embed内嵌文件")]),_:1})]),n("li",null,[a(o,{to:"#打包命令"},{default:p(()=>[s("打包命令")]),_:1}),n("ul",null,[n("li",null,[a(o,{to:"#设置编译环境"},{default:p(()=>[s("设置编译环境")]),_:1})]),n("li",null,[a(o,{to:"#windows"},{default:p(()=>[s("windows")]),_:1})]),n("li",null,[a(o,{to:"#linux"},{default:p(()=>[s("linux")]),_:1})]),n("li",null,[a(o,{to:"#交叉编译代码"},{default:p(()=>[s("交叉编译代码")]),_:1})])])])])]),b,n("ul",null,[n("li",null,[n("a",m,[s("Go语言-打包静态文件"),a(t)])])]),g,n("ul",null,[n("li",null,[n("a",h,[s("https://github.com/mitchellh/gox"),a(t)])]),n("li",null,[n("a",v,[s("https://github.com/wheelcomplex/goxx"),a(t)])]),n("li",null,[n("a",q,[s("https://github.com/goreleaser/goreleaser"),a(t)])]),n("li",null,[n("a",f,[s("https://github.com/laher/goxc"),a(t)])]),n("li",null,[n("a",_,[s("https://github.com/karalabe/xgo"),a(t)])]),n("li",null,[n("a",O,[s("https://github.com/techknowlogick/xgo"),a(t)])]),n("li",null,[n("a",y,[s("https://github.com/storyicon/gos"),a(t)])]),n("li",null,[n("a",G,[s("https://github.com/docker/golang-cross"),a(t)])]),n("li",null,[n("a",x,[s("https://github.com/im4x5yn74x/dropper2"),a(t)])]),n("li",null,[s("Go编译器 "),n("a",w,[s("https://github.com/tinygo-org/tinygo"),a(t)])])]),S,n("ul",null,[n("li",null,[n("a",C,[s("https://github.com/go-bindata/go-bindata"),a(t)])]),n("li",null,[n("a",A,[s("https://github.com/caixw/gobuild"),a(t)])]),n("li",null,[n("a",R,[s("https://github.com/shuLhan/go-bindata"),a(t)])]),n("li",null,[n("a",H,[s("https://github.com/elazarl/go-bindata-assetfs"),a(t)])]),n("li",null,[n("a",E,[s("https://github.com/rakyll/statik"),a(t)])]),n("li",null,[n("a",L,[s("https://github.com/GeertJohan/go.rice"),a(t)])]),n("li",null,[n("a",P,[s("https://github.com/mjibson/esc"),a(t)])]),n("li",null,[n("a",V,[s("https://github.com/UnnoTed/fileb0x"),a(t)])]),n("li",null,[n("a",N,[s("https://github.com/gobuffalo/packr"),a(t)])]),n("li",null,[n("a",F,[s("https://github.com/alecthomas/gobundle"),a(t)])]),n("li",null,[n("a",I,[s("https://github.com/go-playground/statics"),a(t)])]),n("li",null,[n("a",T,[s("https://github.com/knadh/stuffbin"),a(t)])]),n("li",null,[n("a",B,[s("https://github.com/omeid/go-resources"),a(t)])]),n("li",null,[n("a",D,[s("https://github.com/phogolabs/parcello"),a(t)])]),n("li",null,[n("a",j,[s("https://github.com/pyros2097/go-embed"),a(t)])]),n("li",null,[n("a",z,[s("https://github.com/shurcooL/vfsgen"),a(t)])]),n("li",null,[n("a",U,[s("https://github.com/wlbr/templify"),a(t)])]),n("li",null,[n("a",X,[s("https://perkeep.org/pkg/fileembed"),a(t)])]),n("li",null,[n("a",J,[s("https://github.com/kevinburke/go-bindata"),a(t)])]),n("li",null,[n("a",M,[s("https://github.com/markbates/pkger"),a(t)])])]),Q,n("ul",null,[n("li",null,[n("a",K,[s("https://github.com/golang/proposal/blob/master/design/draft-embed.md"),a(t)])]),n("li",null,[s("go:embed扩展 "),n("a",W,[s("https://github.com/alimy/embedx"),a(t)])])]),Y,n("ul",null,[n("li",null,[n("a",Z,[s("Go1.16 中发布的内嵌静态资源功能"),a(t)])]),n("li",null,[n("a",$,[s("golang1.16内嵌静态资源指南"),a(t)])])]),nn,n("ul",null,[n("li",null,[n("a",sn,[s("https://golang.google.cn/doc/install/source#environment"),a(t)])]),n("li",null,[n("a",an,[s("https://gist.github.com/asukakenji/f15ba7e588ac42795f421b48b8aede63"),a(t)])])]),tn,n("ul",null,[n("li",null,[n("a",on,[s("https://github.com/golang/go/blob/master/src/cmd/dist/build.go#L1513"),a(t)])])]),pn,n("ul",null,[n("li",null,[s("用"),en,s("给go链接器传入参数，"),ln,s("查看可用值 "),n("a",cn,[s("https://golang.org/cmd/link"),a(t)])])]),un])}const gn=c(r,[["render",rn],["__file","Go编译打包.html.vue"]]);export{gn as default};
