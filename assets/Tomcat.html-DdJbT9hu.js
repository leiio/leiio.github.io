import{_ as u}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as c,o as i,c as r,b as a,a as t,w as e,d as n,f as l}from"./app-BGG14fOW.js";const d={},k=a("h1",{id:"tomcat",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#tomcat","aria-hidden":"true"},"#"),n(" Tomcat")],-1),m={class:"table-of-contents"},v=a("h2",{id:"flag",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#flag","aria-hidden":"true"},"#"),n(" Flag")],-1),h={href:"https://github.com/topics/tomcat",target:"_blank",rel:"noopener noreferrer"},b={href:"https://github.com/apache/tomcat",target:"_blank",rel:"noopener noreferrer"},g={href:"https://github.com/Aresyi/HowTomcatWorks",target:"_blank",rel:"noopener noreferrer"},q={href:"https://github.com/wildfly/wildfly",target:"_blank",rel:"noopener noreferrer"},_={href:"https://github.com/thorntail/thorntail",target:"_blank",rel:"noopener noreferrer"},x={href:"https://github.com/undertow-io/undertow",target:"_blank",rel:"noopener noreferrer"},f={href:"https://github.com/eclipse/jetty.project",target:"_blank",rel:"noopener noreferrer"},A={href:"https://github.com/eclipse-ee4j/grizzly",target:"_blank",rel:"noopener noreferrer"},T={href:"https://github.com/ran-jit/tomcat-cluster-redis-session-manager",target:"_blank",rel:"noopener noreferrer"},S={href:"https://github.com/psi-probe",target:"_blank",rel:"noopener noreferrer"},E={href:"http://gv7.me/archives",target:"_blank",rel:"noopener noreferrer"},C={href:"https://blog.csdn.net/localhost01/article/details/107340698",target:"_blank",rel:"noopener noreferrer"},w={href:"https://xz.aliyun.com/t/9450",target:"_blank",rel:"noopener noreferrer"},P={href:"https://blog.51cto.com/zero01/2145077",target:"_blank",rel:"noopener noreferrer"},I={href:"https://zhuanlan.zhihu.com/p/150135605",target:"_blank",rel:"noopener noreferrer"},N={href:"https://blog.csdn.net/qq_29534483/article/details/80744027",target:"_blank",rel:"noopener noreferrer"},H={href:"https://www.zhihu.com/question/30977092",target:"_blank",rel:"noopener noreferrer"},L=a("li",null,[n("Linux中，JVM默认编码为UTF-8，在"),a("code",null,"catalina.sh"),n("配置"),a("code",null,'JAVA_OPTS="$JAVA_OPTS -Dfile.encoding=UTF-8"')],-1),M=a("li",null,[n("Windows中，JVM默认编码为GBK，在"),a("code",null,"catalina.bat"),n("配置"),a("code",null,"set JAVA_OPTS=%JAVA_OPTS% -Dfile.encoding=UTF-8")],-1),y=l(`<h2 id="执行器-线程池" tabindex="-1"><a class="header-anchor" href="#执行器-线程池" aria-hidden="true">#</a> 执行器（线程池）</h2><blockquote><p><code>Executor</code> Tomcat默认没有启用线程池，在tomcat中每一个用户请求都是一个线程，所以可以使用线程池提高性能。 这里前台其实有一个调度线程，然后调度线程会放入线程池内，然后到到一定的时候线程池的任务变成工作线程。</p></blockquote><ul><li>在<code>server.xml</code>中找到<code>&lt;Service name=&quot;Catalina&quot;&gt;</code>节点下的<code>Executor</code>标签取消注释</li></ul><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Executor</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tomcatThreadPool<span class="token punctuation">&quot;</span></span> <span class="token attr-name">namePrefix</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>catalina-exec-<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">maxThreads</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>800<span class="token punctuation">&quot;</span></span> <span class="token attr-name">minSpareThreads</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">maxQueueSize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span> <span class="token attr-name">prestartminSpareThreads</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>name</td><td>命名线程池</td></tr><tr><td>threadPriority</td><td>优先级</td></tr><tr><td>daemon</td><td>守护进程</td></tr><tr><td>namePrefix</td><td>名称前缀</td></tr><tr><td>maxThreads</td><td>最大线程数</td></tr><tr><td>minSpareThreads</td><td>最小活跃线程数</td></tr><tr><td>maxIdleTime</td><td>空闲线程等待时间</td></tr><tr><td>maxQueueSize</td><td>最大的等待队里数，超过则请求拒绝</td></tr><tr><td>prestartminSpareThreads</td><td>是否在启动时就生成minSpareThreads个线程</td></tr><tr><td>threadRenewalDelay</td><td>重建线程的时间间隔</td></tr></tbody></table><ul><li>连接器指定线程池：在<code>server.xml</code>中找到<code>&lt;Service name=&quot;Catalina&quot;&gt;</code>节点下的<code>Connector</code>，使用<code>executor=&quot;线程池名称&quot;</code></li></ul><h2 id="连接器优化" tabindex="-1"><a class="header-anchor" href="#连接器优化" aria-hidden="true">#</a> 连接器优化</h2><blockquote><p>Connector是连接器，负责接收客户的请求，以及向客户端回送响应的消息。所以 Connector的优化是重要部分。 默认情况下 Tomcat只支持200线程访问，超过这个数量的连接将被等待甚至超时放弃，所以我们需要提高这方面的处理能力。</p></blockquote>`,8),O={href:"https://blog.csdn.net/qq_34556414/article/details/109176069",target:"_blank",rel:"noopener noreferrer"},z=l(`<table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>maxPostSize</td><td>参数形式处理的最大长度，默认值为2097152（2兆字节）。上传提交的时候可以用的</td></tr><tr><td>acceptCount</td><td>请求的最大队列长度，当队列满时收到的任何请求将被拒绝</td></tr><tr><td>acceptorThreadCount</td><td>用于接受连接的线程的数量</td></tr><tr><td>disableUploadTimeout</td><td>此标志允许servlet容器在数据上传时使用不同的连接超时，通常较长。如果没有指定，该属性被设置为true，禁用上传超时。</td></tr><tr><td>connectionUploadTimeout</td><td>上传数据过程中，指定的以毫秒为单位超时时间。只有在设置disableUploadTimeout为false有效。</td></tr><tr><td>connectionTimeout</td><td>在将提交的请求URI行呈现之后，连接器将等待接受连接的毫秒数。使用值-1表示没有超时（即无限）。默认值是60000（60秒），但请注意，Tomcat的标准server.xml中，设置为20000（即20秒）。</td></tr><tr><td>maxConnections</td><td>服务器接受并处理的最大连接数</td></tr><tr><td>SSLEnabled</td><td>在连接器上使用此属性来启用SSL加密传输</td></tr><tr><td>port</td><td>TCP端口号，连接器利用该端口号将创建一个服务器套接字，并等待传入的连接。</td></tr><tr><td>protocol</td><td>设置协议来处理传入流量。默认值是 HTTP/1.1，将使用自动切换机制来选择阻塞的基于Java的连接器或APR /native 为基础的连接器。可用以下值：org.apache.coyote.http11.Http11Protocol -阻塞式的Java连接器;org.apache.coyote.http11.Http11NioProtocol -不阻塞Java连接器;org.apache.coyote.http11.Http11AprProtocol的 -的APR / native 连接器</td></tr><tr><td>maxThreads</td><td>最多同时处理的连接数，Tomcat使用线程来处理接收的每个请求。这个值表示Tomcat可创建的最大的线程数。如果没有指定，该属性被设置为200。如果使用了execute将忽略此连接器的该属性，连接器将使用execute，而不是一个内部线程池来处理请求。</td></tr><tr><td>minSpareThreads</td><td>始终保持运行最小线程数。如果没有指定，则默认为10。</td></tr><tr><td>maxHttpHeaderSize</td><td>请求和响应的HTTP头的（以字节为单位的）最大尺寸。如果没有指定，该属性被设置为8192（8 KB）。</td></tr><tr><td>tcpNoDelay</td><td>如果设置为true，TCP_NO_DELAY选项将被设置在服务器上的套接字上，在大多数情况下，这样可以提高性能。默认设置为true。</td></tr><tr><td>compression</td><td>通常会在ngnix里面配置压缩开启压缩GZIP，当值是“off ”（禁用压缩），“on ”（允许压缩，这会导致文本数据被压缩），“force ”（强制在所有的情况下压缩），或者一个整数值（这是相当于为“on”，但指定了输出之前被压缩的数据最小量）。如果不知道内容长度但被设置为“on”或更积极的压缩，输出的数据也将被压缩。如果没有指定，该属性被设置为“off”。</td></tr><tr><td>compressionMinSize</td><td>如果压缩被设置为“on”，那么该属性可以用于指定在输出之前被压缩的数据的最小量。如果未指定，此属性默认为“2048”。</td></tr><tr><td>redirectPort</td><td>如果该连接器支持非SSL请求，并且接收到的请求为满足安全约束需要SSL传输， Catalina 将自动将请求重定向到指定的端口号。</td></tr><tr><td>enableLookups</td><td>设置为false时跳过DNS查找，并返回字符串情势的IP地址（从而提高性能）。默认景象下，禁用DNS查找。</td></tr><tr><td>URIEncoding</td><td>指定使用的字符编码，来解码URI字符。如果没有指定，ISO-8859-1将被使用。</td></tr><tr><td>executor</td><td>指向Executor元素的引用。</td></tr><tr><td>compressableMimeType</td><td>可以在<code>conf/web.xml</code>中的<code>Default MIME Type Mappings</code>部分找到</td></tr></tbody></table><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Connector</span> <span class="token attr-name">executor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tomcatThreadPool<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">connectionTimeout</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>20000<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">port</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>8080<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">protocol</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.apache.coyote.http11.Http11Nio2Protocol<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">redirectPort</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>8443<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">maxHttpHeaderSize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>8192<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">enableLookups</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">maxPostSize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1048576000<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">URIEncoding</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">acceptCount</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1000<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">acceptorTreadCount</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">disableUploadTimeout</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">maxConnections</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>10000<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">SSLEnabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">compression</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>on<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">compressionMinSize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2048<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">noCompressionUserAgents</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>gozilla,traviata<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">compressableMimeType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/html,text/xml,application/javascript,text/javascript,text/css,text/plain,text/json<span class="token punctuation">&quot;</span></span>
        <span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="禁用ajp连接器" tabindex="-1"><a class="header-anchor" href="#禁用ajp连接器" aria-hidden="true">#</a> 禁用AJP连接器</h2><ul><li>如果是使用<code>Nginx</code>+<code>tomcat</code>的架构，所以用不着<code>AJP</code>协议，所以把<code>AJP</code>连接器禁用。</li></ul><blockquote><p>AJPv13协议是面向包的。WEB服务器和Servlet容器通过TCP连接来交互；为了节省SOCKET创建的昂贵代价， WEB服务器会尝试维护一个永久TCP连接到servlet容器，并且在多个请求和响应周期过程会重用连接。</p></blockquote><ul><li>在<code>server.xml</code>中找到<code>&lt;Service name=&quot;Catalina&quot;&gt;</code>节点下的<code>Connector</code>标签带有<code>protocol=&quot;AJP/1.3&quot;</code>属性的注释掉</li></ul><h2 id="http头的验证" tabindex="-1"><a class="header-anchor" href="#http头的验证" aria-hidden="true">#</a> http头的验证</h2><blockquote><p>Tomcat在 <code>7.0.73</code>、<code>8.0.39</code>、以及<code>8.5.7</code>版本后，添加了对于<code>http</code>头的验证。</p></blockquote><ul><li>在<code>conf/catalina.properties</code>文件的末尾添加或者修改最后一行</li></ul><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token key attr-name">tomcat.util.http.parser.HttpParser.requestTargetAllow</span><span class="token punctuation">=</span><span class="token value attr-value">|{}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="tomcat热部署" tabindex="-1"><a class="header-anchor" href="#tomcat热部署" aria-hidden="true">#</a> Tomcat热部署</h2><ul><li>在<code>/conf/context.xml</code>的<code>Context</code>标签中配置会使全局生效</li></ul>`,12),B={href:"https://tomcat.apache.org/tomcat-9.0-doc/config/context.html#Attributes",target:"_blank",rel:"noopener noreferrer"},J=l(`<ul><li>在<code>/conf/server.xml</code>的<code>Host</code>标签中配置</li></ul><blockquote><p>替换<code>WEB-INF/lib</code>目录中的<code>jar</code>文件或<code>WEB-INF/classes</code>目录中的<code>class</code>文件时， <code>reloadable=&quot;true&quot;</code>会让修改生效（但代价不小），该选项适合调试。</p></blockquote><blockquote><p>在<code>webapps</code>目录中增加新的目录、<code>war</code>文件、修改<code>WEB-INF/web.xml</code>，<code>autoDeploy=&quot;true&quot;</code>会新建或重新部署应用，该选项方便部署。</p></blockquote><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Context</span> <span class="token attr-name">docBase</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xxx<span class="token punctuation">&quot;</span></span> <span class="token attr-name">path</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/xxx<span class="token punctuation">&quot;</span></span> <span class="token attr-name">reloadable</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token attr-name">autoDeploy</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="_403accessdenied" tabindex="-1"><a class="header-anchor" href="#_403accessdenied" aria-hidden="true">#</a> 403AccessDenied</h2><blockquote><p><code>tomcat8</code>以上管理页面提示<code>403 Access Denied</code>问题</p></blockquote><ul><li>修改<code>conf/tomcat-users.xml</code></li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">vi</span> conf/tomcat-users.xml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>按<code>shift+g</code>跳到末尾,在<code>&lt;/tomcat-users&gt;</code>前添加</li></ul><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>role</span> <span class="token attr-name">rolename</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>manager-gui<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>role</span> <span class="token attr-name">rolename</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>manager-script<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>role</span> <span class="token attr-name">rolename</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>admin-gui<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>role</span> <span class="token attr-name">rolename</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>admin-script<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>user</span> <span class="token attr-name">username</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tomcat<span class="token punctuation">&quot;</span></span> <span class="token attr-name">password</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>密码<span class="token punctuation">&quot;</span></span> <span class="token attr-name">roles</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>manager-gui,manager-script,admin-gui,admin-script<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>修改<code>context.xml</code></li></ul><blockquote><p>打开<code>webapps</code>下的<code>host-manager</code>和<code>manager</code>，在<code>META-INF</code>里面都有<code>context.xml</code></p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">vi</span> webapps/manager/META-INF/context.xml
<span class="token function">vi</span> webapps/host-manager/META-INF/context.xml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>修改<code>&lt;Context antiResourceLocking=&quot;false&quot; privileged=&quot;true&quot; &gt;</code>节点</p></blockquote><blockquote><p>这段代码的作用是限制来访IP的，<code>127.d+.d+.d+|::1|0:0:0:0:0:0:0:1</code>是正则表达式，表示<code>IPv4</code>和<code>IPv6</code>的本机环回地址</p></blockquote><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Valve</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.apache.catalina.valves.RemoteAddrValve<span class="token punctuation">&quot;</span></span>
     <span class="token attr-name">allow</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>127\\.\\d+\\.\\d+\\.\\d+|::1|0:0:0:0:0:0:0:1|\\d+\\.\\d+\\.\\d+\\.\\d+<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="centos安装tomcat" tabindex="-1"><a class="header-anchor" href="#centos安装tomcat" aria-hidden="true">#</a> CentOS安装Tomcat</h2>`,17),D={href:"https://tomcat.apache.org",target:"_blank",rel:"noopener noreferrer"},U=l(`<p><strong>解压</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> apache-tomcat-8.5.31.tar.gz
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>重命名目录</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">mv</span> apache-tomcat-8.5.31 tomcat-8080
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>复制目录</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">cp</span> <span class="token parameter variable">-r</span> tomcat-8080 tomcat-8082
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>修改第二个Tomcat配置</strong></p><blockquote><p>进入tomcat-8082的<code>bin</code>目录，修改<code>startup.sh</code>和<code>shutdown.sh</code>两个文件，都添加如下内容</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment">######### tomcat 2 ##########</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">JAVA_HOME</span><span class="token operator">=</span>JDK安装目录
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token environment constant">$PATH</span><span class="token builtin class-name">:</span><span class="token variable">$JAVA_HOME</span>/bin
<span class="token builtin class-name">export</span> <span class="token assign-left variable">CLASSPATH</span><span class="token operator">=</span><span class="token variable">$JAVA_HOME</span>/lib
<span class="token builtin class-name">export</span> <span class="token assign-left variable">CATALINA_HOME</span><span class="token operator">=</span><span class="token variable">$CATALINA_2_HOME</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">CATALINA_BASE</span><span class="token operator">=</span><span class="token variable">$CATALINA_2_BASE</span>
<span class="token comment">######### tomcat 2 ##########</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>修改第二个tomcat端口,第一个不变</li></ul><blockquote><p>进入<code>/tomcat-8082/conf</code>中修改<code>server.xml</code>修改后示例如下</p></blockquote><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!-- 关闭端口：8005-&gt;9005 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Server</span> <span class="token attr-name">port</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>9005<span class="token punctuation">&quot;</span></span> <span class="token attr-name">shutdown</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>SHUTDOWN<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- Web端口：8080-&gt;8181 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Connector</span> <span class="token attr-name">port</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>8181<span class="token punctuation">&quot;</span></span> <span class="token attr-name">maxHttpHeaderSize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>8192<span class="token punctuation">&quot;</span></span>
<span class="token attr-name">maxThreads</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>150<span class="token punctuation">&quot;</span></span> <span class="token attr-name">minSpareThreads</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>25<span class="token punctuation">&quot;</span></span> <span class="token attr-name">maxSpareThreads</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>75<span class="token punctuation">&quot;</span></span>
<span class="token attr-name">enableLookups</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span> <span class="token attr-name">redirectPort</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>8443<span class="token punctuation">&quot;</span></span> <span class="token attr-name">acceptCount</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span>
<span class="token attr-name">connectionTimeout</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>20000<span class="token punctuation">&quot;</span></span> <span class="token attr-name">disableUploadTimeout</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>

<span class="token comment">&lt;!-- 监听端口：8009-&gt;9009 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Connector</span> <span class="token attr-name">port</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>9009<span class="token punctuation">&quot;</span></span> <span class="token attr-name">enableLookups</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span> <span class="token attr-name">redirectPort</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>8443<span class="token punctuation">&quot;</span></span> <span class="token attr-name">protocol</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>AJP/1.3<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>添加环境变量</strong></p><blockquote><p>在<code>/etc/profile</code>文件中加入下面内容配置环境变量</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment">########## tomcat 1 ###########</span>
<span class="token assign-left variable">CATALINA_BASE</span><span class="token operator">=</span>/home/tomcat-8080
<span class="token assign-left variable">CATALINA_HOME</span><span class="token operator">=</span>/home/tomcat-8080
<span class="token assign-left variable">TOMCAT_HOME</span><span class="token operator">=</span>/home/tomcat-8080
<span class="token builtin class-name">export</span> CATALINA_BASE CATALINA_HOME TOMCAT_HOME
<span class="token comment">########## tomcat 1############</span>

<span class="token comment">######### tomcat 2 ##########</span>
<span class="token assign-left variable">CATALINA_2_BASE</span><span class="token operator">=</span>/home/tomcat-8082
<span class="token assign-left variable">CATALINA_2_HOME</span><span class="token operator">=</span>/home/tomcat-8082
<span class="token assign-left variable">TOMCAT_2_HOME</span><span class="token operator">=</span>/home/tomcat-8082
<span class="token builtin class-name">export</span> CATALINA_2_BASE CATALINA_2_HOME TOMCAT_2_HOME
<span class="token comment">########## tomcat 2##########</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>刷新环境变量</li></ul><blockquote><p><code>source</code>命令也称为“点命令”，也就是一个点符号<code>.</code>。<code>source</code>命令通常用于重新执行刚修改的初始化文件，使之立即生效</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token builtin class-name">source</span> /etc/profile 
<span class="token comment"># 或者</span>
<span class="token builtin class-name">.</span> /etc/profile
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="window运行" tabindex="-1"><a class="header-anchor" href="#window运行" aria-hidden="true">#</a> window运行</h2>`,19),j=l(`<div class="language-batch line-numbers-mode" data-ext="batch"><pre class="language-batch"><code><span class="token comment">:: window下tomcat在当前窗口启动，不在一个新的窗口启动：把start改为run</span>
<span class="token command"><span class="token keyword">call</span> <span class="token string">&quot;%EXECUTABLE%&quot;</span> start <span class="token variable">%CMD_LINE_ARGS%</span></span>
<span class="token command"><span class="token keyword">call</span> <span class="token string">&quot;%EXECUTABLE%&quot;</span> run <span class="token variable">%CMD_LINE_ARGS%</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1);function V(F,R){const o=c("router-link"),s=c("ExternalLinkIcon"),p=c("RouterLink");return i(),r("div",null,[k,a("nav",m,[a("ul",null,[a("li",null,[t(o,{to:"#flag"},{default:e(()=>[n("Flag")]),_:1})]),a("li",null,[t(o,{to:"#执行器-线程池"},{default:e(()=>[n("执行器（线程池）")]),_:1})]),a("li",null,[t(o,{to:"#连接器优化"},{default:e(()=>[n("连接器优化")]),_:1})]),a("li",null,[t(o,{to:"#禁用ajp连接器"},{default:e(()=>[n("禁用AJP连接器")]),_:1})]),a("li",null,[t(o,{to:"#http头的验证"},{default:e(()=>[n("http头的验证")]),_:1})]),a("li",null,[t(o,{to:"#tomcat热部署"},{default:e(()=>[n("Tomcat热部署")]),_:1})]),a("li",null,[t(o,{to:"#_403accessdenied"},{default:e(()=>[n("403AccessDenied")]),_:1})]),a("li",null,[t(o,{to:"#centos安装tomcat"},{default:e(()=>[n("CentOS安装Tomcat")]),_:1})]),a("li",null,[t(o,{to:"#window运行"},{default:e(()=>[n("window运行")]),_:1})])])]),v,a("ul",null,[a("li",null,[a("a",h,[n("https://github.com/topics/tomcat"),t(s)])]),a("li",null,[a("a",b,[n("https://github.com/apache/tomcat"),t(s)])]),a("li",null,[a("a",g,[n("https://github.com/Aresyi/HowTomcatWorks"),t(s)])]),a("li",null,[a("a",q,[n("https://github.com/wildfly/wildfly"),t(s)]),a("ul",null,[a("li",null,[a("a",_,[n("https://github.com/thorntail/thorntail"),t(s)])])])]),a("li",null,[a("a",x,[n("https://github.com/undertow-io/undertow"),t(s)])]),a("li",null,[a("a",f,[n("https://github.com/eclipse/jetty.project"),t(s)])]),a("li",null,[a("a",A,[n("https://github.com/eclipse-ee4j/grizzly"),t(s)])])]),a("ul",null,[a("li",null,[n("Tomcat集群Redis会话管理器 "),a("a",T,[n("https://github.com/ran-jit/tomcat-cluster-redis-session-manager"),t(s)])]),a("li",null,[n("Tomcat监控 "),a("a",S,[n("https://github.com/psi-probe"),t(s)])])]),a("ul",null,[a("li",null,[a("a",E,[n("归档 | 回忆飘如雪"),t(s)])]),a("li",null,[a("a",C,[n("Shiro的反序列化漏洞，以及内存马技术"),t(s)])]),a("li",null,[a("a",w,[n("Java Agent 从入门到内存马"),t(s)])]),a("li",null,[a("a",P,[n("Tomcat性能监控与调优"),t(s)])]),a("li",null,[a("a",I,[n("超详细的Tomcat性能监控及调优教程"),t(s)])]),a("li",null,[a("a",N,[n("Gzip无法压缩48k以上的资源？"),t(s)])])]),a("ul",null,[a("li",null,[a("a",H,[n("java编译器编码和JVM编码问题？"),t(s)])]),L,M]),y,a("ul",null,[a("li",null,[a("a",O,[n("Tomcat 连接器Connector 的三种运行模式 Bio、Nio、Apr"),t(s)])])]),z,a("ul",null,[a("li",null,[a("a",B,[n("https://tomcat.apache.org/tomcat-9.0-doc/config/context.html#Attributes"),t(s)])])]),J,a("ul",null,[a("li",null,[a("a",D,[n("https://tomcat.apache.org"),t(s)])])]),U,a("ul",null,[a("li",null,[t(p,{to:"/Shell/WindowsBatch.html#%E9%9A%90%E8%97%8F%E7%AA%97%E5%8F%A3%E8%BF%90%E8%A1%8C"},{default:e(()=>[n("在文件头部添加隐藏窗口运行")]),_:1}),n("并修改以下文件，执行不显示dos窗口")])]),j])}const G=u(d,[["render",V],["__file","Tomcat.html.vue"]]);export{G as default};
