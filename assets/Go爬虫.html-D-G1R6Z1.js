import{_ as l}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as c,o as u,c as r,b as n,a as t,w as e,d as s,f as p}from"./app-BGG14fOW.js";const d={},k=n("h1",{id:"go爬虫",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#go爬虫","aria-hidden":"true"},"#"),s(" Go爬虫")],-1),m={class:"table-of-contents"},v=n("h2",{id:"flag",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#flag","aria-hidden":"true"},"#"),s(" Flag")],-1),b={href:"https://github.com/go-rod/rod",target:"_blank",rel:"noopener noreferrer"},g={href:"https://github.com/derekparker/delve",target:"_blank",rel:"noopener noreferrer"},f={href:"https://github.com/mafredri/cdp",target:"_blank",rel:"noopener noreferrer"},h={href:"https://github.com/anaskhan96/soup",target:"_blank",rel:"noopener noreferrer"},q=n("h2",{id:"html解析",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#html解析","aria-hidden":"true"},"#"),s(" HTML解析")],-1),y={href:"https://github.com/antchfx",target:"_blank",rel:"noopener noreferrer"},x={href:"https://github.com/PuerkitoBio/goquery",target:"_blank",rel:"noopener noreferrer"},w={href:"https://github.com/gocolly/colly",target:"_blank",rel:"noopener noreferrer"},_={href:"https://github.com/go-predator/predator",target:"_blank",rel:"noopener noreferrer"},A=n("h2",{id:"chromedp",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#chromedp","aria-hidden":"true"},"#"),s(" chromedp")],-1),C={href:"https://github.com/chromedp",target:"_blank",rel:"noopener noreferrer"},S=n("p",null,[n("strong",null,"该组织下有以下项目")],-1),Q=n("ul",null,[n("li",null,[n("code",null,"https://github.com/chromedp/chromedp")])],-1),O={href:"https://godoc.org/github.com/chromedp/chromedp",target:"_blank",rel:"noopener noreferrer"},N=n("ul",null,[n("li",null,[n("code",null,"https://github.com/chromedp/cdproto-gen")])],-1),P={href:"https://chromedevtools.github.io/devtools-protocol",target:"_blank",rel:"noopener noreferrer"},D=n("ul",null,[n("li",null,[n("code",null,"https://github.com/chromedp/cdproto")])],-1),E={href:"https://chromedevtools.github.io/devtools-protocol",target:"_blank",rel:"noopener noreferrer"},B={href:"https://godoc.org/github.com/chromedp/cdproto",target:"_blank",rel:"noopener noreferrer"},T=p("<p><strong><code>cdproto</code>下有以下包</strong></p><ul><li><code>github.com/chromedp/cdproto/cdp</code></li></ul><blockquote><p><code>cdp.TimeSinceEpoch(time.Now().Add(180 * 24 * time.Hour))</code></p></blockquote><ul><li><code>github.com/chromedp/cdproto/network</code> 网络处理</li></ul><blockquote><p>比如启用启用网络跟踪，现在将网络事件传递给客户端<code>network.Enable()</code></p></blockquote><ul><li><code>github.com/chromedp/cdproto/page</code> chrome页面处理</li></ul><blockquote><p>比如设置下载<code>page.SetDownloadBehavior(page.SetDownloadBehaviorBehaviorDeny)</code></p></blockquote>",7),I=n("code",null,"github.com/chromedp/cdproto/target",-1),F={href:"https://chromedevtools.github.io/devtools-protocol/tot/Target#method-createTarget",target:"_blank",rel:"noopener noreferrer"},W=p(`<div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token comment">// 根据url新建浏览器标签页</span>
tag <span class="token operator">:=</span> target<span class="token punctuation">.</span><span class="token function">CreateTarget</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
<span class="token comment">// 新建浏览器标签页ID创建上下文，方式一</span>
ctx<span class="token punctuation">,</span> cancel <span class="token operator">=</span> chromedp<span class="token punctuation">.</span><span class="token function">NewContext</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> chromedp<span class="token punctuation">.</span><span class="token function">WithTargetID</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span><span class="token function">ID</span><span class="token punctuation">(</span>tag<span class="token punctuation">.</span>BrowserContextID<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">// 根据上下文，返回targetID-打开的页面的ID。</span>
tagId<span class="token punctuation">,</span> err <span class="token operator">:=</span> tag<span class="token punctuation">.</span><span class="token function">Do</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
<span class="token comment">// 新建浏览器标签页ID创建上下文，方式二</span>
ctx<span class="token punctuation">,</span> cancel <span class="token operator">=</span> chromedp<span class="token punctuation">.</span><span class="token function">NewContext</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> chromedp<span class="token punctuation">.</span><span class="token function">WithTargetID</span><span class="token punctuation">(</span>tagId<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><code>chromedp.Targets(ctx)</code> 获取浏览器实例的标签页信息列表</p></blockquote><p><strong><code>chromedp</code>能做什么</strong></p><ul><li><p>反爬虫js，例如有的网页后台js自动发送心跳包，浏览器里会自动运行，不需要我们自动处理</p></li><li><p>针对于前端页面的自动化测试</p></li><li><p>解决类似VueJS和SPA之类的渲染</p></li><li><p>解决网页的懒加载</p></li><li><p>网页截图和pdf导出，而不需要额外的去学习其他的库实现</p></li><li><p>seo训练和刷点击量</p></li><li><p>执行javascript 代码</p></li><li><p>设置dom的标签属性</p></li></ul><blockquote><p><code>chromedp</code>同Python的<code>selenium</code>,它是使用<code>Chrome Debugging Protocol</code>(简称cdp) 并且没有外部依赖 (如<code>Selenium</code>, <code>PhantomJS</code>等)</p></blockquote>`,5),L={href:"https://zhangguanzhang.github.io/2019/07/14/chromedp",target:"_blank",rel:"noopener noreferrer"},V={href:"https://mojotv.cn/2018/12/26/chromedp-tutorial-for-golang",target:"_blank",rel:"noopener noreferrer"},R=p('<table><thead><tr><th>函数或变量</th><th>说明</th></tr></thead><tbody><tr><td>(a *ExecAllocator) Allocate(ctx context.Context, opts ...BrowserOption) (*Browser, error)</td><td></td></tr><tr><td>(a *ExecAllocator) Wait()</td><td></td></tr><tr><td>(a *RemoteAllocator) Allocate(ctx context.Context, opts ...BrowserOption) (*Browser, error)</td><td></td></tr><tr><td>(a *RemoteAllocator) Wait()</td><td></td></tr><tr><td>(f ActionFunc) Do(ctx context.Context) error</td><td></td></tr><tr><td>(s *Selector) Do(ctx context.Context) error</td><td></td></tr><tr><td>(t Tasks) Do(ctx context.Context) error</td><td></td></tr><tr><td>After(f func(context.Context, ...*cdp.Node) error) QueryOption</td><td></td></tr><tr><td>AtLeast(n int) QueryOption</td><td></td></tr><tr><td>Attributes(sel interface{}, attributes *map[string]string, opts ...QueryOption) QueryAction</td><td></td></tr><tr><td>AttributesAll(sel interface{}, attributes *[]map[string]string, opts ...QueryOption) QueryAction</td><td></td></tr><tr><td>AttributeValue(sel interface{}, name string, value *string, ok *bool, opts ...QueryOption) QueryAction</td><td></td></tr><tr><td>Blur(sel interface{}, opts ...QueryOption) QueryAction</td><td></td></tr><tr><td>ByFunc(f func(context.Context, *cdp.Node) ([]cdp.NodeID, error)) QueryOption</td><td></td></tr><tr><td>ByID(s *Selector)</td><td>只id来选择元素</td></tr><tr><td>ByJSPath(s *Selector)</td><td></td></tr><tr><td>ByNodeID(s *Selector)</td><td>按节点ID选择元素</td></tr><tr><td>ByQuery(s *Selector)</td><td>根据document.querySelector的规则选择元素，返回单个节点</td></tr><tr><td>ByQueryAll(s *Selector)</td><td>根据document.querySelectorAll返回所有匹配的节点</td></tr><tr><td>BySearch(s *Selector)</td><td>如果不写，默认会使用这个选择器，类似devtools ctrl+f 搜索</td></tr><tr><td>Cancel(ctx context.Context) error</td><td></td></tr><tr><td>CaptureScreenshot(res *[]byte) Action</td><td></td></tr><tr><td>Clear(sel interface{}, opts ...QueryOption) QueryAction</td><td></td></tr><tr><td>Click(sel interface{}, opts ...QueryOption) QueryAction</td><td>触发点击事件</td></tr><tr><td>CombinedOutput(w io.Writer) ExecAllocatorOption</td><td></td></tr><tr><td>ComputedStyle(sel interface{}, style *[]*css.ComputedProperty, opts ...QueryOption) QueryAction</td><td></td></tr><tr><td>Dimensions(sel interface{}, model **dom.BoxModel, opts ...QueryOption) QueryAction</td><td></td></tr><tr><td>DisableGPU(a *ExecAllocator)</td><td>关闭gpu,服务器一般没有显卡</td></tr><tr><td>DoubleClick(sel interface{}, opts ...QueryOption) QueryAction</td><td></td></tr><tr><td>Env(vars ...string) ExecAllocatorOption</td><td>NAME=value形式的通用环境变量列表，用于传递到新的Chrome进程。</td></tr><tr><td>ExecPath(path string) ExecAllocatorOption</td><td></td></tr><tr><td>Flag(name string, value interface{}) ExecAllocatorOption</td><td></td></tr><tr><td>Focus(sel interface{}, opts ...QueryOption) QueryAction</td><td></td></tr><tr><td>FromContext(ctx context.Context) *Context</td><td></td></tr><tr><td>Headless(a *ExecAllocator)</td><td></td></tr><tr><td>InnerHTML(sel interface{}, html *string, opts ...QueryOption) QueryAction</td><td></td></tr><tr><td>JavascriptAttribute(sel interface{}, name string, res interface{}, opts ...QueryOption) QueryAction</td><td></td></tr><tr><td>ListenBrowser(ctx context.Context, fn func(ev interface{}))</td><td></td></tr><tr><td>ListenTarget(ctx context.Context, fn func(ev interface{}))</td><td></td></tr><tr><td>Location(urlstr *string) Action</td><td></td></tr><tr><td>MatchedStyle(sel interface{}, style **css.GetMatchedStylesForNodeReturns, opts ...QueryOption) QueryAction</td><td></td></tr><tr><td>Navigate(urlstr string) NavigateAction</td><td>设置url</td></tr><tr><td>NavigateBack() NavigateAction</td><td></td></tr><tr><td>NavigateForward() NavigateAction</td><td></td></tr><tr><td>NavigateToHistoryEntry(entryID int64) NavigateAction</td><td></td></tr><tr><td>NavigationEntries(currentIndex *int64, entries *[]*page.NavigationEntry) NavigateAction</td><td></td></tr><tr><td>NewContext(parent context.Context, opts ...ContextOption) (context.Context, context.CancelFunc)</td><td></td></tr><tr><td>NewExecAllocator(parent context.Context, opts ...ExecAllocatorOption) (context.Context, context.CancelFunc)</td><td></td></tr><tr><td>NewRemoteAllocator(parent context.Context, url string) (context.Context, context.CancelFunc)</td><td></td></tr><tr><td>NodeEnabled(s *Selector)</td><td></td></tr><tr><td>NoDefaultBrowserCheck(a *ExecAllocator)</td><td>禁用默认浏览器检查。</td></tr><tr><td>NodeIDs(sel interface{}, ids *[]cdp.NodeID, opts ...QueryOption) QueryAction</td><td></td></tr><tr><td>NodeNotPresent(s *Selector)</td><td></td></tr><tr><td>NodeNotVisible(s *Selector)</td><td></td></tr><tr><td>NodeReady(s *Selector)</td><td></td></tr><tr><td>Nodes(sel interface{}, nodes *[]*cdp.Node, opts ...QueryOption) QueryAction</td><td></td></tr><tr><td>NodeSelected(s *Selector)</td><td></td></tr><tr><td>NodeVisible(s *Selector)</td><td></td></tr><tr><td>NoFirstRun(a *ExecAllocator)</td><td>禁用第一次运行对话框的Chrome命令行选项</td></tr><tr><td>NoSandbox(a *ExecAllocator)</td><td>用于禁用沙箱的Chrome命令行选项</td></tr><tr><td>OuterHTML(sel interface{}, html *string, opts ...QueryOption) QueryAction</td><td>获取HTML源码</td></tr><tr><td>ProxyServer(proxy string) ExecAllocatorOption</td><td></td></tr><tr><td>Query(sel interface{}, opts ...QueryOption) QueryAction</td><td></td></tr><tr><td>QueryAfter(sel interface{}, f func(context.Context, ...*cdp.Node) error, opts ...QueryOption) QueryAction</td><td></td></tr><tr><td>Reload() NavigateAction</td><td></td></tr><tr><td>RemoveAttribute(sel interface{}, name string, opts ...QueryOption) QueryAction</td><td></td></tr><tr><td>Reset(sel interface{}, opts ...QueryOption) QueryAction</td><td></td></tr><tr><td>Run(ctx context.Context, actions ...Action) error</td><td></td></tr><tr><td>Screenshot(sel interface{}, picbuf *[]byte, opts ...QueryOption) QueryAction</td><td>标签截图，赋值给变量</td></tr><tr><td>ScrollIntoView(sel interface{}, opts ...QueryOption) QueryAction</td><td></td></tr><tr><td>SendKeys(sel interface{}, v string, opts ...QueryOption) QueryAction</td><td>使用chromedp.ByID选择器。向标签输入内容。</td></tr><tr><td>SetAttributes(sel interface{}, attributes map[string]string, opts ...QueryOption) QueryAction</td><td></td></tr><tr><td>SetAttributeValue(sel interface{}, name, value string, opts ...QueryOption) QueryAction</td><td></td></tr><tr><td>SetJavascriptAttribute(sel interface{}, name, value string, opts ...QueryOption) QueryAction</td><td></td></tr><tr><td>SetUploadFiles(sel interface{}, files []string, opts ...QueryOption) QueryAction</td><td></td></tr><tr><td>SetValue(sel interface{}, value string, opts ...QueryOption) QueryAction</td><td></td></tr><tr><td>Sleep(d time.Duration) Action</td><td>等待时间</td></tr><tr><td>Stop() NavigateAction</td><td></td></tr><tr><td>Submit(sel interface{}, opts ...QueryOption) QueryAction</td><td></td></tr><tr><td>Targets(ctx context.Context) ([]*target.Info, error)</td><td></td></tr><tr><td>Text(sel interface{}, text *string, opts ...QueryOption) QueryAction</td><td></td></tr><tr><td>TextContent(sel interface{}, text *string, opts ...QueryOption) QueryAction</td><td></td></tr><tr><td>Title(title *string) Action</td><td></td></tr><tr><td>UserAgent(userAgent string) ExecAllocatorOption</td><td></td></tr><tr><td>UserDataDir(dir string) ExecAllocatorOption</td><td></td></tr><tr><td>Value(sel interface{}, value *string, opts ...QueryOption) QueryAction</td><td>取值并赋值给变量</td></tr><tr><td>WaitEnabled(sel interface{}, opts ...QueryOption) QueryAction</td><td></td></tr><tr><td>WaitFunc(wait func(context.Context, *cdp.Frame, ...cdp.NodeID) ([]*cdp.Node, error)) QueryOption</td><td></td></tr><tr><td>waitLoaded(ctx context.Context) error</td><td></td></tr><tr><td>WaitNewTarget(ctx context.Context, fn func(*target.Info) bool) &lt;-chan target.ID</td><td></td></tr><tr><td>WaitNotPresent(sel interface{}, opts ...QueryOption) QueryAction</td><td></td></tr><tr><td>WaitNotVisible(sel interface{}, opts ...QueryOption) QueryAction</td><td></td></tr><tr><td>WaitReady(sel interface{}, opts ...QueryOption) QueryAction</td><td></td></tr><tr><td>WaitSelected(sel interface{}, opts ...QueryOption) QueryAction</td><td></td></tr><tr><td>WaitVisible(sel interface{}, opts ...QueryOption) QueryAction</td><td>等待指定标签元素加载完成</td></tr><tr><td>WindowSize(width, height int) ExecAllocatorOption</td><td>设置初始窗口大小的命令行选项。</td></tr><tr><td>WithBrowserOption(opts ...BrowserOption) ContextOption</td><td></td></tr><tr><td>WithDebugf(f func(string, ...interface{})) ContextOption</td><td></td></tr><tr><td>WithErrorf(f func(string, ...interface{})) ContextOption</td><td></td></tr><tr><td>WithLogf(f func(string, ...interface{})) ContextOption</td><td></td></tr><tr><td>WithTargetID(id target.ID) ContextOption</td><td></td></tr></tbody></table><h2 id="godet" tabindex="-1"><a class="header-anchor" href="#godet" aria-hidden="true">#</a> godet</h2>',2),G={href:"https://github.com/raff/godet",target:"_blank",rel:"noopener noreferrer"},M=p(`<ul><li>截图</li></ul><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>
<span class="token keyword">import</span> <span class="token string">&quot;time&quot;</span>

<span class="token keyword">import</span> <span class="token string">&quot;github.com/raff/godet&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// connect to Chrome instance</span>
	remote<span class="token punctuation">,</span> err <span class="token operator">:=</span> godet<span class="token punctuation">.</span><span class="token function">Connect</span><span class="token punctuation">(</span><span class="token string">&quot;localhost:9222&quot;</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;cannot connect to Chrome instance:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// disconnect when done</span>
	<span class="token keyword">defer</span> remote<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token comment">// get browser and protocol version</span>
	version<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> remote<span class="token punctuation">.</span><span class="token function">Version</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>version<span class="token punctuation">)</span>

	<span class="token comment">// get list of open tabs</span>
	tabs<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> remote<span class="token punctuation">.</span><span class="token function">TabList</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>tabs<span class="token punctuation">)</span>

	<span class="token comment">// install some callbacks</span>
	remote<span class="token punctuation">.</span><span class="token function">CallbackEvent</span><span class="token punctuation">(</span>godet<span class="token punctuation">.</span>EventClosed<span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>params godet<span class="token punctuation">.</span>Params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;RemoteDebugger connection terminated.&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>

	remote<span class="token punctuation">.</span><span class="token function">CallbackEvent</span><span class="token punctuation">(</span><span class="token string">&quot;Network.requestWillBeSent&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>params godet<span class="token punctuation">.</span>Params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;requestWillBeSent&quot;</span><span class="token punctuation">,</span>
			params<span class="token punctuation">[</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
			params<span class="token punctuation">[</span><span class="token string">&quot;documentURL&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
			params<span class="token punctuation">[</span><span class="token string">&quot;request&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&quot;url&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>

	remote<span class="token punctuation">.</span><span class="token function">CallbackEvent</span><span class="token punctuation">(</span><span class="token string">&quot;Network.responseReceived&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>params godet<span class="token punctuation">.</span>Params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;responseReceived&quot;</span><span class="token punctuation">,</span>
			params<span class="token punctuation">[</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
			params<span class="token punctuation">[</span><span class="token string">&quot;response&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&quot;url&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>

	remote<span class="token punctuation">.</span><span class="token function">CallbackEvent</span><span class="token punctuation">(</span><span class="token string">&quot;Log.entryAdded&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>params godet<span class="token punctuation">.</span>Params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		entry <span class="token operator">:=</span> params<span class="token punctuation">[</span><span class="token string">&quot;entry&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;LOG&quot;</span><span class="token punctuation">,</span> entry<span class="token punctuation">[</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> entry<span class="token punctuation">[</span><span class="token string">&quot;level&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> entry<span class="token punctuation">[</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>

	<span class="token comment">// block loading of most images</span>
	<span class="token boolean">_</span> <span class="token operator">=</span> remote<span class="token punctuation">.</span><span class="token function">SetBlockedURLs</span><span class="token punctuation">(</span><span class="token string">&quot;*.jpg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;*.png&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;*.gif&quot;</span><span class="token punctuation">)</span>

	<span class="token comment">// create new tab</span>
	tab<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> remote<span class="token punctuation">.</span><span class="token function">NewTab</span><span class="token punctuation">(</span><span class="token string">&quot;https://www.google.com&quot;</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>tab<span class="token punctuation">)</span>

	<span class="token comment">// enable event processing</span>
	remote<span class="token punctuation">.</span><span class="token function">RuntimeEvents</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
	remote<span class="token punctuation">.</span><span class="token function">NetworkEvents</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
	remote<span class="token punctuation">.</span><span class="token function">PageEvents</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
	remote<span class="token punctuation">.</span><span class="token function">DOMEvents</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
	remote<span class="token punctuation">.</span><span class="token function">LogEvents</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>

	<span class="token comment">// navigate in existing tab</span>
	<span class="token boolean">_</span> <span class="token operator">=</span> remote<span class="token punctuation">.</span><span class="token function">ActivateTab</span><span class="token punctuation">(</span>tabs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

	<span class="token comment">//remote.StartPreciseCoverage(true, true)</span>

	<span class="token comment">// re-enable events when changing active tab</span>
	remote<span class="token punctuation">.</span><span class="token function">AllEvents</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token comment">// enable all events</span>

	<span class="token boolean">_</span><span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">=</span> remote<span class="token punctuation">.</span><span class="token function">Navigate</span><span class="token punctuation">(</span><span class="token string">&quot;https://www.google.com&quot;</span><span class="token punctuation">)</span>

	<span class="token comment">// evaluate Javascript expression in existing context</span>
	res<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> remote<span class="token punctuation">.</span><span class="token function">EvaluateWrap</span><span class="token punctuation">(</span><span class="token string">\`
            console.log(&quot;hello from godet!&quot;)
            return 42;
        \`</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>

	<span class="token comment">// take a screenshot</span>
	<span class="token boolean">_</span> <span class="token operator">=</span> remote<span class="token punctuation">.</span><span class="token function">SaveScreenshot</span><span class="token punctuation">(</span><span class="token string">&quot;screenshot.png&quot;</span><span class="token punctuation">,</span> <span class="token number">0644</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>

	time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>

	<span class="token comment">// or save page as PDF</span>
	<span class="token boolean">_</span> <span class="token operator">=</span> remote<span class="token punctuation">.</span><span class="token function">SavePDF</span><span class="token punctuation">(</span><span class="token string">&quot;page.pdf&quot;</span><span class="token punctuation">,</span> <span class="token number">0644</span><span class="token punctuation">,</span> godet<span class="token punctuation">.</span><span class="token function">PortraitMode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            godet<span class="token punctuation">.</span><span class="token function">Scale</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> godet<span class="token punctuation">.</span><span class="token function">Dimensions</span><span class="token punctuation">(</span><span class="token number">6.0</span><span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

	<span class="token comment">// if err := remote.SetInputFiles(0, []string{&quot;hello.txt&quot;}); err != nil {</span>
	<span class="token comment">//     fmt.Println(&quot;setInputFiles&quot;, err)</span>
	<span class="token comment">// }</span>

	time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">5</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>

	<span class="token comment">//remote.StopPreciseCoverage()</span>

	r<span class="token punctuation">,</span> err <span class="token operator">:=</span> remote<span class="token punctuation">.</span><span class="token function">GetPreciseCoverage</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;error profiling&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// Allow downloads</span>
	<span class="token boolean">_</span> <span class="token operator">=</span> remote<span class="token punctuation">.</span><span class="token function">SetDownloadBehavior</span><span class="token punctuation">(</span>godet<span class="token punctuation">.</span>AllowDownload<span class="token punctuation">,</span> <span class="token string">&quot;/tmp/&quot;</span><span class="token punctuation">)</span>
	<span class="token boolean">_</span><span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">=</span> remote<span class="token punctuation">.</span><span class="token function">Navigate</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>

	time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>

	<span class="token comment">// Block downloads</span>
	<span class="token boolean">_</span> <span class="token operator">=</span> remote<span class="token punctuation">.</span><span class="token function">SetDownloadBehavior</span><span class="token punctuation">(</span>godet<span class="token punctuation">.</span>DenyDownload<span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
	<span class="token boolean">_</span><span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">=</span> remote<span class="token punctuation">.</span><span class="token function">Navigate</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="gcd" tabindex="-1"><a class="header-anchor" href="#gcd" aria-hidden="true">#</a> gcd</h2>`,3),H={href:"https://github.com/wirepair/gcd",target:"_blank",rel:"noopener noreferrer"},U=p(`<ul><li>截图</li></ul><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;encoding/base64&quot;</span>
	<span class="token string">&quot;flag&quot;</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;log&quot;</span>
	<span class="token string">&quot;net/url&quot;</span>
	<span class="token string">&quot;os&quot;</span>
	<span class="token string">&quot;runtime&quot;</span>
	<span class="token string">&quot;sync&quot;</span>
	<span class="token string">&quot;time&quot;</span>

	<span class="token string">&quot;github.com/wirepair/gcd&quot;</span>
	<span class="token string">&quot;github.com/wirepair/gcd/gcdapi&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token punctuation">(</span>
	numTabs <span class="token operator">=</span> <span class="token number">5</span>
<span class="token punctuation">)</span>

<span class="token keyword">var</span> debugger <span class="token operator">*</span>gcd<span class="token punctuation">.</span>Gcd
<span class="token keyword">var</span> wg sync<span class="token punctuation">.</span>WaitGroup

<span class="token keyword">var</span> path <span class="token builtin">string</span>
<span class="token keyword">var</span> dir <span class="token builtin">string</span>
<span class="token keyword">var</span> port <span class="token builtin">string</span>

<span class="token keyword">func</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">switch</span> runtime<span class="token punctuation">.</span>GOOS <span class="token punctuation">{</span>
	<span class="token keyword">case</span> <span class="token string">&quot;windows&quot;</span><span class="token punctuation">:</span>
		flag<span class="token punctuation">.</span><span class="token function">StringVar</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>path<span class="token punctuation">,</span> <span class="token string">&quot;chrome&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;C:\\\\Program Files (x86)\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;path to chrome&quot;</span><span class="token punctuation">)</span>
		flag<span class="token punctuation">.</span><span class="token function">StringVar</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>dir<span class="token punctuation">,</span> <span class="token string">&quot;dir&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;C:\\\\temp\\\\&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;user directory&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">case</span> <span class="token string">&quot;darwin&quot;</span><span class="token punctuation">:</span>
		flag<span class="token punctuation">.</span><span class="token function">StringVar</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>path<span class="token punctuation">,</span> <span class="token string">&quot;chrome&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;/Applications/Google Chrome.app/Contents/MacOS/Google Chrome&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;path to chrome&quot;</span><span class="token punctuation">)</span>
		flag<span class="token punctuation">.</span><span class="token function">StringVar</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>dir<span class="token punctuation">,</span> <span class="token string">&quot;dir&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/tmp/&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;user directory&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">case</span> <span class="token string">&quot;linux&quot;</span><span class="token punctuation">:</span>
		flag<span class="token punctuation">.</span><span class="token function">StringVar</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>path<span class="token punctuation">,</span> <span class="token string">&quot;chrome&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/usr/bin/chromium-browser&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;path to chrome&quot;</span><span class="token punctuation">)</span>
		flag<span class="token punctuation">.</span><span class="token function">StringVar</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>dir<span class="token punctuation">,</span> <span class="token string">&quot;dir&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/tmp/&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;user directory&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	flag<span class="token punctuation">.</span><span class="token function">StringVar</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>port<span class="token punctuation">,</span> <span class="token string">&quot;port&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;9222&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Debugger port&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> err <span class="token builtin">error</span>
	urls <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;http://www.google.com&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;http://www.veracode.com&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;http://www.microsoft.com&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;http://bbc.co.uk&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;http://www.reddit.com/r/golang&quot;</span><span class="token punctuation">}</span>

	flag<span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	debugger <span class="token operator">=</span> gcd<span class="token punctuation">.</span><span class="token function">NewChromeDebugger</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	debugger<span class="token punctuation">.</span><span class="token function">StartProcess</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> dir<span class="token punctuation">,</span> port<span class="token punctuation">)</span>
	<span class="token keyword">defer</span> debugger<span class="token punctuation">.</span><span class="token function">ExitProcess</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	targets <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>gcd<span class="token punctuation">.</span>ChromeTarget<span class="token punctuation">,</span> numTabs<span class="token punctuation">)</span>

	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> numTabs<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
		wg<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
		targets<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> err <span class="token operator">=</span> debugger<span class="token punctuation">.</span><span class="token function">NewTab</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
			log<span class="token punctuation">.</span><span class="token function">Fatalf</span><span class="token punctuation">(</span><span class="token string">&quot;error getting targets&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		page <span class="token operator">:=</span> targets<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Page
		page<span class="token punctuation">.</span><span class="token function">Enable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		targets<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">Subscribe</span><span class="token punctuation">(</span><span class="token string">&quot;Page.loadEventFired&quot;</span><span class="token punctuation">,</span> pageLoaded<span class="token punctuation">)</span>
		<span class="token comment">// navigate</span>
		navigateParams <span class="token operator">:=</span> <span class="token operator">&amp;</span>gcdapi<span class="token punctuation">.</span>PageNavigateParams<span class="token punctuation">{</span>Url<span class="token punctuation">:</span> urls<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">}</span>
		<span class="token boolean">_</span><span class="token punctuation">,</span> <span class="token boolean">_</span><span class="token punctuation">,</span> <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> page<span class="token punctuation">.</span><span class="token function">NavigateWithParams</span><span class="token punctuation">(</span>navigateParams<span class="token punctuation">)</span>
		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
			log<span class="token punctuation">.</span><span class="token function">Fatalf</span><span class="token punctuation">(</span><span class="token string">&quot;error: %s\\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	wg<span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> numTabs<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
		<span class="token function">takeScreenShot</span><span class="token punctuation">(</span>targets<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">pageLoaded</span><span class="token punctuation">(</span>target <span class="token operator">*</span>gcd<span class="token punctuation">.</span>ChromeTarget<span class="token punctuation">,</span> event <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	target<span class="token punctuation">.</span><span class="token function">Unsubscribe</span><span class="token punctuation">(</span><span class="token string">&quot;Page.loadEventFired&quot;</span><span class="token punctuation">)</span>
	wg<span class="token punctuation">.</span><span class="token function">Done</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">takeScreenShot</span><span class="token punctuation">(</span>target <span class="token operator">*</span>gcd<span class="token punctuation">.</span>ChromeTarget<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	dom <span class="token operator">:=</span> target<span class="token punctuation">.</span>DOM
	page <span class="token operator">:=</span> target<span class="token punctuation">.</span>Page
	doc<span class="token punctuation">,</span> err <span class="token operator">:=</span> dom<span class="token punctuation">.</span><span class="token function">GetDocument</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;error getting doc: %s\\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>

	debugger<span class="token punctuation">.</span><span class="token function">ActivateTab</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>
	time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span> <span class="token comment">// give it a sec to paint</span>
	u<span class="token punctuation">,</span> urlErr <span class="token operator">:=</span> url<span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>doc<span class="token punctuation">.</span>DocumentURL<span class="token punctuation">)</span>
	<span class="token keyword">if</span> urlErr <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;error parsing url: %s\\n&quot;</span><span class="token punctuation">,</span> urlErr<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>

	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Taking screen shot of: %s\\n&quot;</span><span class="token punctuation">,</span> u<span class="token punctuation">.</span>Host<span class="token punctuation">)</span>
	screenShotParams <span class="token operator">:=</span> <span class="token operator">&amp;</span>gcdapi<span class="token punctuation">.</span>PageCaptureScreenshotParams<span class="token punctuation">{</span>Format<span class="token punctuation">:</span> <span class="token string">&quot;png&quot;</span><span class="token punctuation">,</span>
                                FromSurface<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span>
	img<span class="token punctuation">,</span> errCap <span class="token operator">:=</span> page<span class="token punctuation">.</span><span class="token function">CaptureScreenshotWithParams</span><span class="token punctuation">(</span>screenShotParams<span class="token punctuation">)</span>
	<span class="token keyword">if</span> errCap <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;error getting doc: %s\\n&quot;</span><span class="token punctuation">,</span> errCap<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>

	imgBytes<span class="token punctuation">,</span> errDecode <span class="token operator">:=</span> base64<span class="token punctuation">.</span>StdEncoding<span class="token punctuation">.</span><span class="token function">DecodeString</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span>
	<span class="token keyword">if</span> errDecode <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;error decoding image: %s\\n&quot;</span><span class="token punctuation">,</span> errDecode<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>

	f<span class="token punctuation">,</span> errFile <span class="token operator">:=</span> os<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span>u<span class="token punctuation">.</span>Host <span class="token operator">+</span> <span class="token string">&quot;.png&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">defer</span> f<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> errFile <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;error creating image file: %s\\n&quot;</span><span class="token punctuation">,</span> errFile<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	f<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>imgBytes<span class="token punctuation">)</span>
	debugger<span class="token punctuation">.</span><span class="token function">CloseTab</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2);function J(j,z){const o=c("router-link"),i=c("RouterLink"),a=c("ExternalLinkIcon");return u(),r("div",null,[k,n("nav",m,[n("ul",null,[n("li",null,[t(o,{to:"#flag"},{default:e(()=>[s("Flag")]),_:1})]),n("li",null,[t(o,{to:"#html解析"},{default:e(()=>[s("HTML解析")]),_:1})]),n("li",null,[t(o,{to:"#chromedp"},{default:e(()=>[s("chromedp")]),_:1})]),n("li",null,[t(o,{to:"#godet"},{default:e(()=>[s("godet")]),_:1})]),n("li",null,[t(o,{to:"#gcd"},{default:e(()=>[s("gcd")]),_:1})])])]),v,n("p",null,[n("strong",null,[t(i,{to:"/Web/#xpath%E5%92%8Ccss%E9%80%89%E6%8B%A9%E5%99%A8"},{default:e(()=>[s("xpath和css选择器")]),_:1})])]),n("p",null,[n("strong",null,[t(i,{to:"/IDE/Chrome.html#HeadlessBrowser"},{default:e(()=>[s("HeadlessBrowser")]),_:1})])]),n("ul",null,[n("li",null,[n("a",b,[s("https://github.com/go-rod/rod"),t(a)])]),n("li",null,[n("a",g,[s("https://github.com/derekparker/delve"),t(a)])]),n("li",null,[n("a",f,[s("https://github.com/mafredri/cdp"),t(a)])]),n("li",null,[s("类BeautifulSoup "),n("a",h,[s("https://github.com/anaskhan96/soup"),t(a)])])]),q,n("ul",null,[n("li",null,[n("a",y,[s("https://github.com/antchfx"),t(a)]),s(" htmlquery使用xpath选择器")]),n("li",null,[n("a",x,[s("https://github.com/PuerkitoBio/goquery"),t(a)]),s(" goquery使用css选择器")]),n("li",null,[n("a",w,[s("https://github.com/gocolly/colly"),t(a)])]),n("li",null,[n("a",_,[s("https://github.com/go-predator/predator"),t(a)])])]),A,n("ul",null,[n("li",null,[n("a",C,[s("https://github.com/chromedp"),t(a)])])]),S,Q,n("blockquote",null,[n("p",null,[n("a",O,[s("https://godoc.org/github.com/chromedp/chromedp"),t(a)])])]),N,n("blockquote",null,[n("p",null,[s("生成用于"),n("a",P,[s("Chrome DevTools"),t(a)]),s("协议的命令，事件和类型的Go代码")])]),D,n("blockquote",null,[n("p",null,[s("包含针对"),n("a",E,[s("Chrome DevTools"),t(a)]),s("协议域生成的命令，类型和事件")])]),n("blockquote",null,[n("p",null,[n("a",B,[s("https://godoc.org/github.com/chromedp/cdproto"),t(a)])])]),T,n("ul",null,[n("li",null,[I,s(" 操作标签页 "),n("a",F,[s("Target.createTarget"),t(a)])])]),W,n("ul",null,[n("li",null,[n("a",L,[s("golang headless browser包chromedp初探"),t(a)])]),n("li",null,[n("a",V,[s("go语言chromedp使用教程"),t(a)])])]),R,n("ul",null,[n("li",null,[n("a",G,[s("https://github.com/raff/godet"),t(a)])])]),M,n("ul",null,[n("li",null,[n("a",H,[s("https://github.com/wirepair/gcd"),t(a)])])]),U])}const Y=l(d,[["render",J],["__file","Go爬虫.html.vue"]]);export{Y as default};
